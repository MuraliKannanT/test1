type: "transformation"
version: "1.0"
pipeline:
  components:
    flatten_jemp:
      type: "extract-nested-data-sf"
      sources:
      - "JEMP"
      parameters:
        componentName: "flatten_jemp"
        includeInputColumns: "No"
        columns:
        - name: "address"
          datatype: "VARIANT"
          size: "0"
          decimalPlaces: "0"
          columnName: "VC"
          aliasName: "address"
          isArray: "false"
          include: "false"
          childElements:
          - name: "city"
            datatype: "VARCHAR"
            size: "0"
            decimalPlaces: "0"
            columnName: "VC"
            aliasName: "city"
            isArray: "false"
            include: "true"
          - name: "street"
            datatype: "VARCHAR"
            size: "0"
            decimalPlaces: "0"
            columnName: "VC"
            aliasName: "street"
            isArray: "false"
            include: "true"
          - name: "zip"
            datatype: "NUMBER"
            size: "0"
            decimalPlaces: "0"
            columnName: "VC"
            aliasName: "zip"
            isArray: "false"
            include: "true"
          - name: "state"
            datatype: "VARCHAR"
            size: "0"
            decimalPlaces: "0"
            columnName: "VC"
            aliasName: "state"
            isArray: "false"
            include: "true"
        - name: "date_entered"
          datatype: "VARCHAR"
          size: "0"
          decimalPlaces: "0"
          columnName: "VC"
          aliasName: "date_entered"
          isArray: "false"
          include: "true"
        - name: "dealership"
          datatype: "VARIANT"
          size: "0"
          decimalPlaces: "0"
          columnName: "VC"
          aliasName: "dealership"
          isArray: "false"
          include: "false"
          childElements:
          - name: "id"
            datatype: "NUMBER"
            size: "0"
            decimalPlaces: "0"
            columnName: "VC"
            aliasName: "dealership_id"
            isArray: "false"
            include: "true"
          - name: "region"
            datatype: "VARCHAR"
            size: "0"
            decimalPlaces: "0"
            columnName: "VC"
            aliasName: "region"
            isArray: "false"
            include: "true"
        - name: "email"
          datatype: "VARCHAR"
          size: "0"
          decimalPlaces: "0"
          columnName: "VC"
          aliasName: "email"
          isArray: "false"
          include: "true"
        - name: "employee"
          datatype: "VARIANT"
          size: "0"
          decimalPlaces: "0"
          columnName: "VC"
          aliasName: "employee"
          isArray: "false"
          include: "false"
          childElements:
          - name: "firstname"
            datatype: "VARCHAR"
            size: "0"
            decimalPlaces: "0"
            columnName: "VC"
            aliasName: "firstname"
            isArray: "false"
            include: "true"
          - name: "gender"
            datatype: "VARCHAR"
            size: "0"
            decimalPlaces: "0"
            columnName: "VC"
            aliasName: "gender"
            isArray: "false"
            include: "true"
          - name: "id"
            datatype: "NUMBER"
            size: "0"
            decimalPlaces: "0"
            columnName: "VC"
            aliasName: "employee_id"
            isArray: "false"
            include: "true"
          - name: "lastname"
            datatype: "VARCHAR"
            size: "0"
            decimalPlaces: "0"
            columnName: "VC"
            aliasName: "lastname"
            isArray: "false"
            include: "true"
          - name: "age"
            datatype: "NUMBER"
            size: "0"
            decimalPlaces: "0"
            columnName: "VC"
            aliasName: "age"
            isArray: "false"
            include: "true"
        - name: "hire_date"
          datatype: "VARCHAR"
          size: "0"
          decimalPlaces: "0"
          columnName: "VC"
          aliasName: "hire_date"
          isArray: "false"
          include: "true"
        - name: "phone"
          datatype: "VARIANT"
          size: "0"
          decimalPlaces: "0"
          columnName: "VC"
          aliasName: "phone"
          isArray: "false"
          include: "false"
          childElements:
          - name: "fixed"
            datatype: "NUMBER"
            size: "0"
            decimalPlaces: "0"
            columnName: "VC"
            aliasName: "fixed"
            isArray: "false"
            include: "true"
          - name: "mobile"
            datatype: "NUMBER"
            size: "0"
            decimalPlaces: "0"
            columnName: "VC"
            aliasName: "mobile"
            isArray: "false"
            include: "true"
        - name: "position"
          datatype: "VARCHAR"
          size: "0"
          decimalPlaces: "0"
          columnName: "VC"
          aliasName: "position"
          isArray: "false"
          include: "true"
        outerJoin: "False"
        inputAlias: "i"
        arrayPrefix: "f"
        castingMethod: "Fail on invalid data"
        caseColumnAliasNames: "Upper"
    JEMP:
      type: "table-input"
      parameters:
        componentName: "JEMP"
        database: "[Environment Default]"
        schema: "SOURCE"
        targetTable: "JEMP"
        columnNames:
        - "VC"
        timeOffset: ""
    emp_sal:
      type: "sql"
      parameters:
        componentName: "emp_sal"
        query: "select $1::number(8) eid, $2::number(8) sal, 'Manager'::string mgr\
          \ from @s3_sense"
    Join 0:
      type: "join"
      sources:
      - "Variant_jemp"
      - "emp_sal"
      parameters:
        componentName: "Join 0"
        mainTable: "Variant_jemp"
        mainTableAlias: "main"
        joins:
        - - "emp_sal"
          - "sal"
          - "Inner"
        joinExpressions:
        - - "\"main\".\"EMPLOYEE_ID\"=\"sal\".\"EID\""
          - "main_Inner_sal"
        columnMappings:
        - - "main.EMPLOYEE_ID"
          - "EMPLOYEE_ID"
        - - "main.EMPLOYEE_FIRST_NAME"
          - "EMPLOYEE_FIRST_NAME"
        - - "main.EMPLOYEE_LAST_NAME"
          - "EMPLOYEE_LAST_NAME"
        - - "main.EMPLOYEE_ADDRESS"
          - "EMPLOYEE_ADDRESS"
        - - "main.EMPLOYEE_CITY"
          - "EMPLOYEE_CITY"
        - - "main.EMPLOYEE_STATE"
          - "EMPLOYEE_STATE"
        - - "main.EMPLOYEE_ZIP_CODE"
          - "EMPLOYEE_ZIP_CODE"
        - - "main.EMPLOYEE_MOBILE"
          - "EMPLOYEE_MOBILE"
        - - "main.EMPLOYEE_FIXEDLINE"
          - "EMPLOYEE_FIXEDLINE"
        - - "main.EMPLOYEE_EMAIL"
          - "EMPLOYEE_EMAIL"
        - - "main.EMPLOYEE_GENDER"
          - "EMPLOYEE_GENDER"
        - - "main.EMPLOYEE_AGE"
          - "EMPLOYEE_AGE"
        - - "main.POSITION_TYPE"
          - "POSITION_TYPE"
        - - "main.DEALERSHIP_ID"
          - "DEALERSHIP_ID"
        - - "sal.SAL"
          - "SAL"
        - - "sal.MGR"
          - "MGR"
        - - "main.REGION"
          - "REGION"
        - - "main.HIRED_DATE"
          - "HIRED_DATE"
        - - "main.DATE_ENTERED"
          - "DATE_ENTERED"
    Variant_jemp:
      type: "flatten-variant"
      sources:
      - "flatten_jemp"
      parameters:
        componentName: "Variant_jemp"
        includeInputColumns: "No"
        columnMapping:
        - - "employee_id"
          - ""
          - "NUMBER"
          - "EMPLOYEE_ID"
        - - "firstname"
          - ""
          - "VARCHAR"
          - "EMPLOYEE_FIRST_NAME"
        - - "lastname"
          - ""
          - "VARCHAR"
          - "EMPLOYEE_LAST_NAME"
        - - "street"
          - ""
          - "VARCHAR"
          - "EMPLOYEE_ADDRESS"
        - - "city"
          - ""
          - "VARCHAR"
          - "EMPLOYEE_CITY"
        - - "state"
          - ""
          - "VARCHAR"
          - "EMPLOYEE_STATE"
        - - "zip"
          - ""
          - "NUMBER"
          - "EMPLOYEE_ZIP_CODE"
        - - "mobile"
          - ""
          - "NUMBER"
          - "EMPLOYEE_MOBILE"
        - - "fixed"
          - ""
          - "VARCHAR"
          - "EMPLOYEE_FIXEDLINE"
        - - "email"
          - ""
          - "VARCHAR"
          - "EMPLOYEE_EMAIL"
        - - "gender"
          - ""
          - "VARCHAR"
          - "EMPLOYEE_GENDER"
        - - "age"
          - ""
          - "NUMBER"
          - "EMPLOYEE_AGE"
        - - "position"
          - ""
          - "VARCHAR"
          - "POSITION_TYPE"
        - - "dealership_id"
          - ""
          - "NUMBER"
          - "DEALERSHIP_ID"
        - - "region"
          - ""
          - "VARCHAR"
          - "REGION"
        - - "hire_date"
          - ""
          - "DATE"
          - "HIRED_DATE"
        - - "date_entered"
          - ""
          - "DATE"
          - "DATE_ENTERED"
        columnFlattens:
    STG_EMPLOYEES:
      type: "table-output"
      sources:
      - "Join 0"
      parameters:
        componentName: "STG_EMPLOYEES"
        warehouse: "[Environment Default]"
        database: "[Environment Default]"
        schema: "[Environment Default]"
        targetTable: "STG_EMPLOYEES"
        fixDataTypeMismatches: "No"
        columnMapping:
        - - "EMPLOYEE_ID"
          - "EMPLOYEE_ID"
        - - "EMPLOYEE_FIRST_NAME"
          - "EMPLOYEE_FIRST_NAME"
        - - "EMPLOYEE_LAST_NAME"
          - "EMPLOYEE_LAST_NAME"
        - - "EMPLOYEE_ADDRESS"
          - "EMPLOYEE_ADDRESS"
        - - "EMPLOYEE_CITY"
          - "EMPLOYEE_CITY"
        - - "EMPLOYEE_STATE"
          - "EMPLOYEE_STATE"
        - - "EMPLOYEE_ZIP_CODE"
          - "EMPLOYEE_ZIP_CODE"
        - - "EMPLOYEE_MOBILE"
          - "EMPLOYEE_MOBILE"
        - - "EMPLOYEE_FIXEDLINE"
          - "EMPLOYEE_FIXEDLINE"
        - - "EMPLOYEE_EMAIL"
          - "EMPLOYEE_EMAIL"
        - - "EMPLOYEE_GENDER"
          - "EMPLOYEE_GENDER"
        - - "EMPLOYEE_AGE"
          - "EMPLOYEE_AGE"
        - - "POSITION_TYPE"
          - "POSITION_TYPE"
        - - "DEALERSHIP_ID"
          - "DEALERSHIP_ID"
        - - "SAL"
          - "SALARY"
        - - "MGR"
          - "DEALERSHIP_MANAGER"
        - - "REGION"
          - "REGION"
        - - "HIRED_DATE"
          - "HIRE_DATE"
        - - "DATE_ENTERED"
          - "DATE_ENTERED"
        orderBy:
        outputMode: "Append"
design:
  components:
    flatten_jemp:
      position:
        x: 320
        "y": 96
      tempMetlId: 7410
    JEMP:
      position:
        x: 192
        "y": 96
      tempMetlId: 7436
    emp_sal:
      position:
        x: 272
        "y": 16
      tempMetlId: 7469
    Join 0:
      position:
        x: 528
        "y": 48
      tempMetlId: 7483
    Variant_jemp:
      position:
        x: 432
        "y": 80
      tempMetlId: 7537
    STG_EMPLOYEES:
      position:
        x: 640
        "y": 47
      tempMetlId: 7572
